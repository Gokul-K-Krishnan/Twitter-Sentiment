{"paragraphs":[{"text":"import org.apache.spark.streaming._\nimport org.apache.spark.streaming.twitter._\nimport org.apache.spark.storage.StorageLevel\nimport scala.io.Source\nimport scala.collection.mutable.HashMap\nimport java.io.File\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport sys.process.stringSeqToProcess\n\n/** Configures the Oauth Credentials for accessing Twitter */\ndef configureTwitterCredentials(apiKey: String, apiSecret: String, accessToken: String, accessTokenSecret: String) {\n  val configs = new HashMap[String, String] ++= Seq(\n    \"apiKey\" -> apiKey, \"apiSecret\" -> apiSecret, \"accessToken\" -> accessToken, \"accessTokenSecret\" -> accessTokenSecret)\n  println(\"Configuring Twitter OAuth\")\n  configs.foreach{ case(key, value) =>\n    if (value.trim.isEmpty) {\n      throw new Exception(\"Error setting authentication - value for \" + key + \" not set\")\n    }\n    val fullKey = \"twitter4j.oauth.\" + key.replace(\"api\", \"consumer\")\n    System.setProperty(fullKey, value.trim)\n    println(\"\\tProperty \" + fullKey + \" set as [\" + value.trim + \"]\")\n  }\n  println()\n}\n\n// Configure Twitter credentials\nval apiKey = \"SArrLUs3FH1QWM1dzLgrJZQZR\"\nval apiSecret = \"kWKc1hkjO4eWxBGveD1ztlIMbay7ny6aY6i289omA5FVGTMVdy\"\nval accessToken = \"824754411826188288-YIKCP2DQNf61gGrrStyzr8RX5LGhSjG\"\nval accessTokenSecret = \"bB5W9q7IfTFVZA64fQ0jEFfjMWhj7DchS8EPqoc1E9V55\"\nconfigureTwitterCredentials(apiKey, apiSecret, accessToken, accessTokenSecret)\n","dateUpdated":"2017-01-26T19:14:06-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485475809869_-232642785","id":"20170126-191009_595319873","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.streaming._\n\nimport org.apache.spark.streaming.twitter._\n\nimport org.apache.spark.storage.StorageLevel\n\nimport scala.io.Source\n\nimport scala.collection.mutable.HashMap\n\nimport java.io.File\n\nimport org.apache.log4j.Logger\n\nimport org.apache.log4j.Level\nConfiguring Twitter OAuth\n\tProperty twitter4j.oauth.consumerKey set as [SArrLUs3FH1QWM1dzLgrJZQZR]\n\tProperty twitter4j.oauth.accessToken set as [824754411826188288-YIKCP2DQNf61gGrrStyzr8RX5LGhSjG]\n\tProperty twitter4j.oauth.consumerSecret set as [kWKc1hkjO4eWxBGveD1ztlIMbay7ny6aY6i289omA5FVGTMVdy]\n\tProperty twitter4j.oauth.accessTokenSecret set as [bB5W9q7IfTFVZA64fQ0jEFfjMWhj7DchS8EPqoc1E9V55]\n\n\n\n\n\n\n\nimport sys.process.stringSeqToProcess\nconfigureTwitterCredentials: (apiKey: String, apiSecret: String, accessToken: String, accessTokenSecret: String)Unit\napiKey: String = SArrLUs3FH1QWM1dzLgrJZQZR\napiSecret: String = kWKc1hkjO4eWxBGveD1ztlIMbay7ny6aY6i289omA5FVGTMVdy\naccessToken: String = 824754411826188288-YIKCP2DQNf61gGrrStyzr8RX5LGhSjG\naccessTokenSecret: String = bB5W9q7IfTFVZA64fQ0jEFfjMWhj7DchS8EPqoc1E9V55\n"},"dateCreated":"2017-01-26T19:10:09-0500","dateStarted":"2017-01-26T19:14:06-0500","dateFinished":"2017-01-26T19:14:28-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2759","focus":true},{"text":"import org.apache.spark.streaming.twitter._\nval ssc = new StreamingContext(sc, Seconds(2))\nval tweets = TwitterUtils.createStream(ssc, None)\nval twt = tweets.window(Seconds(60))\n\ncase class Tweet(createdAt:Long, text:String)\ntwt.map(status=>\n  Tweet(status.getCreatedAt().getTime()/1000, status.getText())\n).foreachRDD(rdd=>rdd.toDF().registerTempTable(\"tweets\")\n)\ntwt.print\n\nssc.start()","dateUpdated":"2017-01-26T19:16:08-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485475964862_1216519142","id":"20170126-191244_1741745468","dateCreated":"2017-01-26T19:12:44-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2760","dateFinished":"2017-01-26T19:16:12-0500","dateStarted":"2017-01-26T19:16:08-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.streaming.twitter._\n\nssc: org.apache.spark.streaming.StreamingContext = org.apache.spark.streaming.StreamingContext@60b62446\n\ntweets: org.apache.spark.streaming.dstream.ReceiverInputDStream[twitter4j.Status] = org.apache.spark.streaming.twitter.TwitterInputDStream@3bd76f90\n\ntwt: org.apache.spark.streaming.dstream.DStream[twitter4j.Status] = org.apache.spark.streaming.dstream.WindowedDStream@655645c2\n\ndefined class Tweet\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"createdAt","index":0,"aggr":"sum"}],"values":[{"name":"text","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"createdAt","index":0,"aggr":"sum"},"yAxis":{"name":"text","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485476119945_-555402784","id":"20170126-191519_873558926","dateCreated":"2017-01-26T19:15:19-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2927","dateUpdated":"2017-01-26T19:17:51-0500","dateFinished":"2017-01-26T19:17:52-0500","dateStarted":"2017-01-26T19:17:51-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"createdAt\ttext\n1485476210\tIf Trump thinks pissing off the Mexicans and making Modelo Especial more expensive makes America great again, he needs to think again 😡😡🍺😡😡\n1485476211\tLa llegada de Trump convierte ‘1984’ en superventas en EE UU https://t.co/9OaAYXCJwE vía @el_pais\n1485476211\tRT @FoxNews: Bystanders Cheer on Police as They Break Up Anti-#Trump Protest in OR\nhttps://t.co/ih8ckbO3dy\n1485476213\tRT @revlDonaldTrump: Don't let them get to you, #TrumpTrain!! https://t.co/017vBeY3IK\n1485476215\tRT @ENTORNOi: Actriz iraní boicotea los Oscar en protesta a Trump  https://t.co/rsG3s7XBC7 #NoTextAndDrive https://t.co/b5lF3KF0NL\n1485476216\tRT @AndrewMinDC: @asherhuey @realDonaldTrump No, he's just deflecting from the bigger issue that Russia did it and he's not legitimate.\n1485476218\tRT @Trumpnado2016: Headline Correction: Trump plans to make American consumers pay for #TrumpsStupidFuckingWall via price hikes.\nhttps://t.…\n1485476222\tRT @OfficialSPGB: @realDonaldTrump You said Mexico would pay. Now you say the US will pay and the cost will be reclaimed. LIAR. Mexic… \n1485476222\tRT @realDonaldTrump: Will be interviewed by @SeanHannity on @FoxNews at 10:00pm tonight. Enjoy!\n1485476222\tRT @ProPublica: \"Everything is subject to review,\" said head of Trump's EPA transition team\nData, studies, etc, all will be reviewe… \n","comment":"","msgTable":[[{"key":"text","value":"1485476210"},{"key":"text","value":"If Trump thinks pissing off the Mexicans and making Modelo Especial more expensive makes America great again, he needs to think again 😡😡🍺😡😡"}],[{"value":"1485476211"},{"value":"La llegada de Trump convierte ‘1984’ en superventas en EE UU https://t.co/9OaAYXCJwE vía @el_pais"}],[{"value":"1485476211"},{"value":"RT @FoxNews: Bystanders Cheer on Police as They Break Up Anti-#Trump Protest in OR"}],[{"value":"https://t.co/ih8ckbO3dy"}],[{"value":"1485476213"},{"value":"RT @revlDonaldTrump: Don't let them get to you, #TrumpTrain!! https://t.co/017vBeY3IK"}],[{"value":"1485476215"},{"value":"RT @ENTORNOi: Actriz iraní boicotea los Oscar en protesta a Trump  https://t.co/rsG3s7XBC7 #NoTextAndDrive https://t.co/b5lF3KF0NL"}],[{"value":"1485476216"},{"value":"RT @AndrewMinDC: @asherhuey @realDonaldTrump No, he's just deflecting from the bigger issue that Russia did it and he's not legitimate."}],[{"value":"1485476218"},{"value":"RT @Trumpnado2016: Headline Correction: Trump plans to make American consumers pay for #TrumpsStupidFuckingWall via price hikes."}],[{"value":"https://t.…"}],[{"value":"1485476222"},{"value":"RT @OfficialSPGB: @realDonaldTrump You said Mexico would pay. Now you say the US will pay and the cost will be reclaimed. LIAR. Mexic… "}],[{"value":"1485476222"},{"value":"RT @realDonaldTrump: Will be interviewed by @SeanHannity on @FoxNews at 10:00pm tonight. Enjoy!"}],[{"value":"1485476222"},{"value":"RT @ProPublica: \"Everything is subject to review,\" said head of Trump's EPA transition team"}],[{"value":"Data, studies, etc, all will be reviewe… "}]],"columnNames":[{"name":"createdAt","index":0,"aggr":"sum"},{"name":"text","index":1,"aggr":"sum"}],"rows":[["1485476210","If Trump thinks pissing off the Mexicans and making Modelo Especial more expensive makes America great again, he needs to think again 😡😡🍺😡😡"],["1485476211","La llegada de Trump convierte ‘1984’ en superventas en EE UU https://t.co/9OaAYXCJwE vía @el_pais"],["1485476211","RT @FoxNews: Bystanders Cheer on Police as They Break Up Anti-#Trump Protest in OR"],["https://t.co/ih8ckbO3dy"],["1485476213","RT @revlDonaldTrump: Don't let them get to you, #TrumpTrain!! https://t.co/017vBeY3IK"],["1485476215","RT @ENTORNOi: Actriz iraní boicotea los Oscar en protesta a Trump  https://t.co/rsG3s7XBC7 #NoTextAndDrive https://t.co/b5lF3KF0NL"],["1485476216","RT @AndrewMinDC: @asherhuey @realDonaldTrump No, he's just deflecting from the bigger issue that Russia did it and he's not legitimate."],["1485476218","RT @Trumpnado2016: Headline Correction: Trump plans to make American consumers pay for #TrumpsStupidFuckingWall via price hikes."],["https://t.…"],["1485476222","RT @OfficialSPGB: @realDonaldTrump You said Mexico would pay. Now you say the US will pay and the cost will be reclaimed. LIAR. Mexic… "],["1485476222","RT @realDonaldTrump: Will be interviewed by @SeanHannity on @FoxNews at 10:00pm tonight. Enjoy!"],["1485476222","RT @ProPublica: \"Everything is subject to review,\" said head of Trump's EPA transition team"],["Data, studies, etc, all will be reviewe… "]]},"text":"%sql select * from tweets where text like '%Trump%' limit 10"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"createdAt","index":0,"aggr":"sum"}],"values":[{"name":"count(1)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"createdAt","index":0,"aggr":"sum"},"yAxis":{"name":"count(1)","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485476571852_-138692366","id":"20170126-192251_1221414315","dateCreated":"2017-01-26T19:22:51-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3370","text":"%sql select createdAt, count(1) from tweets group by createdAt order by createdAt","dateUpdated":"2017-01-26T19:23:20-0500","dateFinished":"2017-01-26T19:23:23-0500","dateStarted":"2017-01-26T19:23:20-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"createdAt\tcount(1)\n1485476539\t50\n1485476540\t43\n1485476541\t47\n1485476542\t36\n1485476543\t33\n1485476544\t33\n1485476545\t42\n1485476546\t42\n1485476547\t47\n1485476548\t40\n1485476549\t29\n1485476550\t46\n1485476551\t30\n1485476552\t43\n1485476553\t32\n1485476554\t39\n1485476555\t36\n1485476556\t35\n1485476557\t34\n1485476558\t59\n1485476559\t50\n1485476560\t33\n1485476561\t45\n1485476562\t45\n1485476563\t37\n1485476564\t37\n1485476565\t38\n1485476566\t32\n1485476567\t39\n1485476568\t37\n1485476569\t38\n1485476570\t26\n1485476571\t42\n1485476572\t42\n1485476573\t33\n1485476574\t39\n1485476575\t33\n1485476576\t36\n1485476577\t50\n1485476578\t42\n1485476579\t26\n1485476580\t37\n1485476581\t49\n1485476582\t48\n1485476583\t36\n1485476584\t42\n1485476585\t37\n1485476586\t51\n1485476587\t52\n1485476588\t30\n1485476589\t41\n1485476590\t37\n1485476591\t41\n1485476592\t38\n1485476593\t39\n1485476594\t41\n1485476595\t39\n1485476596\t30\n1485476597\t29\n1485476598\t39\n","comment":"","msgTable":[[{"key":"count(1)","value":"1485476539"},{"key":"count(1)","value":"50"}],[{"value":"1485476540"},{"value":"43"}],[{"value":"1485476541"},{"value":"47"}],[{"value":"1485476542"},{"value":"36"}],[{"value":"1485476543"},{"value":"33"}],[{"value":"1485476544"},{"value":"33"}],[{"value":"1485476545"},{"value":"42"}],[{"value":"1485476546"},{"value":"42"}],[{"value":"1485476547"},{"value":"47"}],[{"value":"1485476548"},{"value":"40"}],[{"value":"1485476549"},{"value":"29"}],[{"value":"1485476550"},{"value":"46"}],[{"value":"1485476551"},{"value":"30"}],[{"value":"1485476552"},{"value":"43"}],[{"value":"1485476553"},{"value":"32"}],[{"value":"1485476554"},{"value":"39"}],[{"value":"1485476555"},{"value":"36"}],[{"value":"1485476556"},{"value":"35"}],[{"value":"1485476557"},{"value":"34"}],[{"value":"1485476558"},{"value":"59"}],[{"value":"1485476559"},{"value":"50"}],[{"value":"1485476560"},{"value":"33"}],[{"value":"1485476561"},{"value":"45"}],[{"value":"1485476562"},{"value":"45"}],[{"value":"1485476563"},{"value":"37"}],[{"value":"1485476564"},{"value":"37"}],[{"value":"1485476565"},{"value":"38"}],[{"value":"1485476566"},{"value":"32"}],[{"value":"1485476567"},{"value":"39"}],[{"value":"1485476568"},{"value":"37"}],[{"value":"1485476569"},{"value":"38"}],[{"value":"1485476570"},{"value":"26"}],[{"value":"1485476571"},{"value":"42"}],[{"value":"1485476572"},{"value":"42"}],[{"value":"1485476573"},{"value":"33"}],[{"value":"1485476574"},{"value":"39"}],[{"value":"1485476575"},{"value":"33"}],[{"value":"1485476576"},{"value":"36"}],[{"value":"1485476577"},{"value":"50"}],[{"value":"1485476578"},{"value":"42"}],[{"value":"1485476579"},{"value":"26"}],[{"value":"1485476580"},{"value":"37"}],[{"value":"1485476581"},{"value":"49"}],[{"value":"1485476582"},{"value":"48"}],[{"value":"1485476583"},{"value":"36"}],[{"value":"1485476584"},{"value":"42"}],[{"value":"1485476585"},{"value":"37"}],[{"value":"1485476586"},{"value":"51"}],[{"value":"1485476587"},{"value":"52"}],[{"value":"1485476588"},{"value":"30"}],[{"value":"1485476589"},{"value":"41"}],[{"value":"1485476590"},{"value":"37"}],[{"value":"1485476591"},{"value":"41"}],[{"value":"1485476592"},{"value":"38"}],[{"value":"1485476593"},{"value":"39"}],[{"value":"1485476594"},{"value":"41"}],[{"value":"1485476595"},{"value":"39"}],[{"value":"1485476596"},{"value":"30"}],[{"value":"1485476597"},{"value":"29"}],[{"value":"1485476598"},{"value":"39"}]],"columnNames":[{"name":"createdAt","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["1485476539","50"],["1485476540","43"],["1485476541","47"],["1485476542","36"],["1485476543","33"],["1485476544","33"],["1485476545","42"],["1485476546","42"],["1485476547","47"],["1485476548","40"],["1485476549","29"],["1485476550","46"],["1485476551","30"],["1485476552","43"],["1485476553","32"],["1485476554","39"],["1485476555","36"],["1485476556","35"],["1485476557","34"],["1485476558","59"],["1485476559","50"],["1485476560","33"],["1485476561","45"],["1485476562","45"],["1485476563","37"],["1485476564","37"],["1485476565","38"],["1485476566","32"],["1485476567","39"],["1485476568","37"],["1485476569","38"],["1485476570","26"],["1485476571","42"],["1485476572","42"],["1485476573","33"],["1485476574","39"],["1485476575","33"],["1485476576","36"],["1485476577","50"],["1485476578","42"],["1485476579","26"],["1485476580","37"],["1485476581","49"],["1485476582","48"],["1485476583","36"],["1485476584","42"],["1485476585","37"],["1485476586","51"],["1485476587","52"],["1485476588","30"],["1485476589","41"],["1485476590","37"],["1485476591","41"],["1485476592","38"],["1485476593","39"],["1485476594","41"],["1485476595","39"],["1485476596","30"],["1485476597","29"],["1485476598","39"]]}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485476222718_-549141177","id":"20170126-191702_2040249603","dateCreated":"2017-01-26T19:17:02-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3027","dateUpdated":"2017-01-26T19:21:47-0500","dateFinished":"2017-01-26T19:21:49-0500","dateStarted":"2017-01-26T19:21:47-0500","result":{"code":"SUCCESS","type":"TEXT","msg":"\nsentiment: (s: String)String\n\nres7: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n"},"text":"def sentiment(s:String) : String = {\n    val positive = Array(\"like\", \"love\", \"good\", \"great\", \"happy\", \"cool\", \"the\", \"one\", \"that\")\n    val negative = Array(\"hate\", \"bad\", \"stupid\", \"is\")\n\n    var st = 0;\n\n    val words = s.split(\" \")    \n    positive.foreach(p =>\n        words.foreach(w =>\n            if(p==w) st = st+1\n        )\n    )\n\n    negative.foreach(p=>\n        words.foreach(w=>\n            if(p==w) st = st-1\n        )\n    )\n    if(st>0)\n        \"positivie\"\n    else if(st<0)\n        \"negative\"\n    else\n        \"neutral\"\n}\n\n// Below line works only in spark 1.3.0.\n// For spark 1.1.x and spark 1.2.x,\n// use sqlc.registerFunction(\"sentiment\", sentiment _) instead.\nsqlc.udf.register(\"sentiment\", sentiment _)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"UDF(text)","index":0,"aggr":"sum"}],"values":[{"name":"count(1)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"UDF(text)","index":0,"aggr":"sum"},"yAxis":{"name":"count(1)","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485476507312_45309553","id":"20170126-192147_1183212515","dateCreated":"2017-01-26T19:21:47-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3189","dateUpdated":"2017-01-26T19:22:34-0500","dateFinished":"2017-01-26T19:22:36-0500","dateStarted":"2017-01-26T19:22:35-0500","result":{"code":"SUCCESS","type":"TABLE","msg":"UDF(text)\tcount(1)\nneutral\t3\nnegative\t2\npositivie\t2\n","comment":"","msgTable":[[{"key":"count(1)","value":"neutral"},{"key":"count(1)","value":"3"}],[{"value":"negative"},{"value":"2"}],[{"value":"positivie"},{"value":"2"}]],"columnNames":[{"name":"UDF(text)","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["neutral","3"],["negative","2"],["positivie","2"]]},"text":"%sql select sentiment(text), count(1) from tweets where text like '%trump%' group by sentiment(text)\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485476538525_-188755696","id":"20170126-192218_196636116","dateCreated":"2017-01-26T19:22:18-0500","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3271","dateUpdated":"2017-01-26T19:22:43-0500","text":""}],"name":"Twitter","id":"2C9ZUMX5R","angularObjects":{"2C9J7XG99:shared_process":[],"2C7B3MEYX:shared_process":[],"2C87M67DT:shared_process":[],"2CABVQYS4:shared_process":[],"2C9BSDJHF:shared_process":[],"2C7JG8MNF:shared_process":[],"2C9WYVU4D:shared_process":[],"2CA86ZE8B:shared_process":[],"2C79BTR21:shared_process":[],"2C7CDBBBC:shared_process":[],"2C9RZRP67:shared_process":[],"2C7WXWG8A:shared_process":[],"2CA2T21TJ:shared_process":[],"2C8U4A5NP:shared_process":[],"2C78F6FEE:shared_process":[],"2CA37CX73:shared_process":[],"2CAA1Y8X8:shared_process":[],"2C85VYDSR:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}